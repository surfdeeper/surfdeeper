---
import type { SectionData } from "../../utils/sidebar-data";

export interface Props {
  section: SectionData;
}

const { section } = Astro.props;
---

<li class="section-item">
  <a href={`/guide/${section.slug}`} class="section-link">
    {section.label}
  </a>
  {
    section.guides.length > 0 && (
      <ul class="nested-links">
        {section.visibleGuides.map((guide) => (
          <li>
            <a href={guide.url}>{guide.title}</a>
          </li>
        ))}
        {section.remainingCount > 0 && (
          <li class="more-items">
            <a href={`/guide/${section.slug}`}>
              {section.remainingCount} more â†’
            </a>
          </li>
        )}
        {section.comingSoonCount > 0 && (
          <li class="coming-soon-items">
            {section.comingSoonCount} coming soon
          </li>
        )}
      </ul>
    )
  }
</li>

<style>
  /* Nested navigation - hide on mobile, show on desktop */
  .nested-links {
    display: none;
  }

  /* Sidebar links: neutral text color with subtle hover */
  .section-link,
  .nested-links a {
    color: var(--color-text-primary);
    text-decoration: none;
    font-size: var(--font-size-sm);
    opacity: 0.8;
    transition: opacity var(--transition-fast);
    display: block;
  }

  .section-link:hover,
  .nested-links a:hover {
    opacity: 1;
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  /* Preserve neutral color for visited state */
  .section-link:visited,
  .nested-links a:visited {
    color: var(--color-text-primary);
  }

  @media (min-width: 1200px) {
    .nested-links {
      display: block;
      list-style: none;
      padding: 0;
      margin: var(--space-2) 0 0 var(--space-4);
    }

    .nested-links li {
      margin-bottom: var(--space-2);
    }

    .nested-links .coming-soon-items {
      color: var(--color-accent);
      font-style: italic;
      opacity: 0.6;
      font-size: var(--font-size-xs);
    }
  }
</style>
